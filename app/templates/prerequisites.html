{% extends "base.html" %}

{% block title %}Prerequisites - Databricks Workspace Creator{% endblock %}

{% block content %}
<div class="container">
    <div class="header">
        <h1>üöÄ Prerequisites Check</h1>
        <p class="subtitle">Before configuring your Databricks workspace, let's ensure you have everything needed to deploy with Terraform.</p>
    </div>

    <a href="{{ url_for('azure.azure_templates') }}" class="back-btn">‚Üê Back to Azure Templates</a>

    <div class="prereq-section">
        <div class="prereq-title">What is Terraform?</div>
        <div class="prereq-content">
            <p>Terraform is an infrastructure-as-code tool that allows you to define and deploy cloud resources safely and predictably. It uses configuration files to describe the desired state of your infrastructure.</p>
            <p>This application uses Terraform to deploy your Databricks workspace with all necessary cloud resources (networks, security groups, storage, etc.).</p>
        </div>
    </div>

    <div class="prereq-section">
        <div class="prereq-title">Required Software</div>
        <div class="prereq-content">
            <div class="step">
                <div class="step-number">1. Install Terraform CLI</div>
                <p>Download and install Terraform from the official HashiCorp website:</p>
                <div class="code-block">
# For macOS (using Homebrew)  <br>
brew tap hashicorp/tap  <br>
brew install hashicorp/tap/terraform  <br> <br>

# For other platforms, visit: https://www.terraform.io/downloads
                </div>
                <p>Verify installation:</p>
                <div class="code-block">terraform version</div>
            </div>

            <div class="step">
                <div class="step-number">2. Install Azure CLI (for Azure templates)</div>
                <p>If you're deploying to Azure, install the Azure CLI:</p>
                <div class="code-block">
# For macOS <br>
brew install azure-cli <br> <br>

# Login to Azure <br>
az login
                </div>
            </div>

            <div class="step">
                <div class="step-number">3. Install AWS CLI (for AWS templates)</div>
                <p>If you're deploying to AWS, install the AWS CLI:</p>
                <div class="code-block">
# For macOS <br>
brew install awscli <br> <br>

# Configure AWS credentials <br>
aws configure
                </div>
            </div>
        </div>
    </div>

    <div class="prereq-section">
        <div class="prereq-title">Cloud Provider Access</div>
        <div class="prereq-content">
            <p>You need appropriate permissions in your cloud provider account:</p>
            <ul>
                <li><strong>Azure:</strong> Contributor or Owner role on the subscription/resource group</li>
                <li><strong>AWS:</strong> AdministratorAccess or appropriate IAM permissions for EC2, VPC, S3, IAM</li>
                <li><strong>GCP:</strong> Editor or Owner role on the project</li>
            </ul>
        </div>
    </div>

    <div class="prereq-section">
        <div class="prereq-title">Databricks Account</div>
        <div class="prereq-content">
            <p>You'll need a Databricks account with:</p>
            <ul>
                <li>Account admin privileges to create workspaces</li>
                <li>Account ID (found in your Databricks account console)</li>
                <li>Client ID and Client Secret from a service principal</li>
            </ul>
        </div>
    </div>

    <div class="prereq-section">
        <div class="prereq-title">Network and Security</div>
        <div class="prereq-content">
            <p>Ensure your network allows outbound connections to:</p>
            <ul>
                <li>Cloud provider APIs (Azure ARM, AWS EC2, etc.)</li>
                <li>Databricks control plane (accounts.cloud.databricks.com)</li>
                <li>Terraform registry (registry.terraform.io)</li>
            </ul>
        </div>
    </div>

    <div class="prereq-section">
        <div class="prereq-title">Download Template</div>
        <div class="prereq-content">
            <p>Once you have all the prerequisites installed, download the Terraform template to your local machine:</p>
            <div class="text-center" style="margin: 30px 0;">
                <a href="{{ url_for('azure.download_clean_template', template_name=template_name) }}" class="btn" style="background: linear-gradient(135deg, #28a745 0%, #20c997 100%); margin-bottom: 15px;">üì• Download {{ template_name }} Template</a>
            </div>
        </div>
    </div>

    <div class="prereq-section">
        <div class="prereq-title">Local Deployment Instructions</div>
        <div class="prereq-content">
            <p>After downloading the template:</p>
            <div class="step">
                <div class="step-number">1. Extract the ZIP file</div>
                <p>Unzip the downloaded file to a directory on your local machine.</p>
            </div>
        </div>
    </div>

    <div class="text-center">
        <a href="{{ url_for('azure.azure_templates') }}" class="btn">‚Üê Back to Templates</a>
    </div>
</div>
{% endblock %}